<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Nicko Hristov ">
<meta name="description" content="Having hundreds of gigabytes and sometimes even multiple terabytes can get fastly very challanging for regular transfers and backups. Therefore we can make management very easy when instead using network storage, which only needs to be mounted on the corresponding machines. The following should serve as a cheatsheet for quickly setting up samba shares on the home network.
Install and setup samba $ sudo apt update &amp;amp;&amp;amp; sudo apt install samba For security disable Samba NetBIOS service, as we won&amp;rsquo;t use it." />
<meta name="keywords" content="homepage, blog, network, smb, file-sharing, tech" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://nickohristov.de/posts/smb/" />


    <title>
        
            Setup file sharing with SMB :: Hi, I&#39;m Nicko Hristov!  — A student by day, a coder by night.
        
    </title>







<link rel="stylesheet" href="/main.c47edf39e235b482df2ff83840628fb6b276216c064604f24f8a226699cb571e.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Setup file sharing with SMB">
<meta itemprop="description" content="Having hundreds of gigabytes and sometimes even multiple terabytes can get fastly very challanging for regular transfers and backups. Therefore we can make management very easy when instead using network storage, which only needs to be mounted on the corresponding machines. The following should serve as a cheatsheet for quickly setting up samba shares on the home network.
Install and setup samba $ sudo apt update &amp;&amp; sudo apt install samba For security disable Samba NetBIOS service, as we won&rsquo;t use it."><meta itemprop="datePublished" content="2022-03-10T16:00:00+01:00" />
<meta itemprop="dateModified" content="2022-03-10T16:00:00+01:00" />
<meta itemprop="wordCount" content="413"><meta itemprop="image" content="https://nickohristov.de"/>
<meta itemprop="keywords" content="network,smb,file-sharing,tech," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://nickohristov.de"/>

<meta name="twitter:title" content="Setup file sharing with SMB"/>
<meta name="twitter:description" content="Having hundreds of gigabytes and sometimes even multiple terabytes can get fastly very challanging for regular transfers and backups. Therefore we can make management very easy when instead using network storage, which only needs to be mounted on the corresponding machines. The following should serve as a cheatsheet for quickly setting up samba shares on the home network.
Install and setup samba $ sudo apt update &amp;&amp; sudo apt install samba For security disable Samba NetBIOS service, as we won&rsquo;t use it."/>








    <meta property="article:published_time" content="2022-03-10 16:00:00 &#43;0100 CET" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">$</span>
            <span class="logo__text">cd ~</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#379cff;
                   animation-duration:1.1s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/posts">Posts</a></li><li><a href="/about">About</a></li><li><a href="/sources">Sources</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        2 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://nickohristov.de/posts/smb/">Setup file sharing with SMB</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>Having hundreds of gigabytes and sometimes even multiple terabytes can get fastly very challanging for regular transfers and backups. Therefore we can make management very easy when instead using network storage, which only needs to be mounted on the corresponding machines. The following should serve as a cheatsheet for quickly setting up samba shares on the home network.</p>
<h1 id="install-and-setup-samba">Install and setup samba</h1>
<pre tabindex="0"><code>$ sudo apt update &amp;&amp; sudo apt install samba
</code></pre><p>For security disable Samba NetBIOS service, as we won&rsquo;t use it.</p>
<pre tabindex="0"><code>$ sudo systemctl disable --now nmbd.service
</code></pre><p>To avoid security issues that can arise from running an unconfigured, network-enabled service, let’s stop the Samba server until configuration details are in place:</p>
<pre tabindex="0"><code>$ sudo systemctl stop smbd.service
</code></pre><h1 id="configure-samba-global">Configure Samba global</h1>
<pre tabindex="0"><code>$ sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak &amp;&amp; sudo nano /etc/samba/smb.conf
</code></pre><pre tabindex="0"><code>[global]
        server string = samba_server
        server role = standalone server
        bind interfaces only = yes
        disable netbios = yes
        smb ports = 445
        log file = /var/log/samba/smb.log
        max log size = 10000
</code></pre><p>after editing <code>smb.conf</code> always run <code>testparm</code> to check that there are no syntax errors.
If testparm reports <em>Loaded services file OK.</em>, then there are no syntax errors that would stop the Samba server from starting.</p>
<h1 id="setup-samba-user--share">Setup Samba user &amp; share</h1>
<h3 id="create-samba-root-directory">Create Samba root directory</h3>
<pre tabindex="0"><code>$ sudo mkdir /samba/
$ sudo chown :sambashare /samba/
</code></pre><h3 id="create-samba-user">Create Samba user</h3>
<pre tabindex="0"><code>$ sudo mkdir /samba/joe
$ sudo adduser --home /samba/joe --no-create-home --shell /usr/sbin/nologin --ingroup sambashare joe

$ sudo chown joe:sambashare /samba/joe/
$ sudo chmod 2770 /samba/joe/

$ sudo smbpasswd -a joe
$ sudo smbpasswd -e joe
</code></pre><h3 id="setup-share">Setup share</h3>
<pre tabindex="0"><code>[joe]
        path = /samba/joe
        browseable = no
        read only = no
        force create mode = 0660
        force directory mode = 2770
        valid users = joe
</code></pre><pre tabindex="0"><code>$ testparm &amp;&amp; sudo systemctl start smbd
</code></pre><h1 id="configure-samba-clients">Configure Samba Clients</h1>
<pre tabindex="0"><code>$ sudo apt update &amp;&amp; sudo apt install smbclient cifs-utils
</code></pre><p>Accessing Samba share temporarily:</p>
<pre tabindex="0"><code>$ smbclient //10.0.1.18/joe -U joe
</code></pre><p>You can mount a samba share to a directory in your local Linux system using the mount and cifs type option.</p>
<pre tabindex="0"><code>$ mkdir /mnt/smb
$ sudo mount -t cifs -o username=joe //10.0.1.18/joe /mnt/smb
$ df -h
</code></pre><h3 id="mount-samba-share-using-fstab">Mount Samba share using fstab.</h3>
<p>You can use fstab file to persist Samba shares mounting through system reboots. In my example, I have the following line added to the end of <code>/ect/fstab</code> file.</p>
<pre tabindex="0"><code>//10.0.1.18/joe /mnt/smb cifs credentials=/.smbcreds 0 0
</code></pre><pre tabindex="0"><code>$ cat &lt;&lt; EOF &gt; /.smbcreds
username=joe
password=supersecretpassword
domain=WORKGROUP
EOF
</code></pre><p>To test:</p>
<pre tabindex="0"><code>$ sudo mkdir -p /mnt/smb
$ sudo mount -a
$ df -hT | grep cifs
</code></pre><h3 id="repos">Repos:</h3>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-a-samba-share-for-a-small-organization-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-set-up-a-samba-share-for-a-small-organization-on-ubuntu-16-04</a></li>
<li><a href="https://computingforgeeks.com/install-and-configure-samba-server-share-on-ubuntu/">https://computingforgeeks.com/install-and-configure-samba-server-share-on-ubuntu/</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://nickohristov.de/tags/network/">network</a></span>
        <span class="tag"><a href="https://nickohristov.de/tags/smb/">smb</a></span>
        <span class="tag"><a href="https://nickohristov.de/tags/file-sharing/">file-sharing</a></span>
        <span class="tag"><a href="https://nickohristov.de/tags/tech/">tech</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        413 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-03-10 16:00
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://nickohristov.de/posts/search-queries/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Effective search queries</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://nickohristov.de/posts/gpg/">
                    <span class="button__text">GnuPG Cheatsheet</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&#127279;2022</span>
            <span><a href="https://n1ck0h21570v.onion">Tor</a></span>
            <span><a href="/gdpr/">GDPR<a></a></span>
            
            
            
            <span><a href="https://nickohristov.de/posts/index.xml" target="_blank" title="rss">RSS<svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 21 21" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
            
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
		     
            <span><span class="text"></span></span>
         </div>
    
</footer>

            
        </div>

        





<script type="text/javascript" src="/bundle.min.d23700b4adce1aad57aa5afd1b861f14d38ba7784c5c1e0f1e405e0986d009f95e0bc45d462c0e4d4cc333b093a7ca401f2586edbb63b039142ce47e9e047864.js" integrity="sha512-0jcAtK3OGq1Xqlr9G4YfFNOLp3hMXB4PHkBeCYbQCfleC8RdRiwOTUzDM7CTp8pAHyWG7btjsDkULOR&#43;ngR4ZA=="></script>



    </body>
</html>
